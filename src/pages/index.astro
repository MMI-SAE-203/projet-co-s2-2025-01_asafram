---
import Layout from "../layouts/Layout.astro";
import BulleDegrade from "../assets/fond/bulle-degrade.svg";
import IconeRecette from "../assets/icones/book-food.webp";
import IconeCommunaute from "../assets/icones/communaute.webp";
import IconeFavoris from "../assets/icones/star-favoris.webp";
import AccueilCard from "../components/AccueilCard.astro";
import CardCommentaires from "../components/CardCommentaires.astro";
import ImageLinh from "../assets/images/linh.webp";
import ImageThomas from "../assets/images/thomas.webp";
import ImageAicha from "../assets/images/aicha.webp";
import ImageYanis from "../assets/images/yanis.webp";
import IconeBoutique from "../assets/icones/icone-boutique.webp";
import IconePlanete from "../assets/icones/icone-planete.webp";
import IconeRestaurants from "../assets/icones/icone-restaurants.webp";
import IconeCompte from "../assets/icones/icone-compte.webp";
import BulleAccueil from "../components/BulleAccueil.astro";
import FondAccueil from "../assets/fond/accueil-desktop.svg";
import IconeFirst from "../assets/icones/icone-first.svg";
import Transition from "../components/Transition.astro";
import IconeEnvoyer from "../assets/icones/icone-envoyer.webp";
---

<Layout>
  <section
    class="bg-background h-auto md:h-[800px] lg:h-[1150px] xl:h-[1300px] relative overflow-hidden z-0"
  >
    <div class="absolute inset-0 w-full h-full z-0">
      <img
        src={BulleDegrade.src}
        alt=""
        aria-hidden="true"
        class="w-full h-full object-cover"
      />
    </div>
    <div class="relative z-1">
      <header
        class="flex flex-col justify-center items-center gap-4 mt-24 md:mt-28 lg:mt-36"
      >
        <div
          class="flex justify-center items-center gap-2 md:gap-3 lg:gap-4 border rounded-full py-1 md:py-1.5 lg:py-2 px-3 md:px-3.5 lg:px-4"
        >
          <img
            src={IconeFirst.src}
            alt=""
            aria-hidden="true"
            class="w-5 md:w-6 lg:w-auto"
          />
          <p class="font-bold text-sm md:text-base lg:text-lg">
            La référence des saveurs du monde
          </p>
        </div>
        <h1
          class="text-4xl md:text-5xl lg:text-7xl flex flex-col gap-2 md:gap-3 lg:gap-4 pb-3 md:pb-4 lg:pb-6 text-center"
        >
          <span class="text-5xl md:text-6xl lg:text-8xl"
            >Retrouver le goût de</span
          >
          <span class="text-5xl md:text-6xl lg:text-8xl text-saumon"
            >chez soi !</span
          >
        </h1>
        <p
          class="font-black text-2xl md:text-3xl lg:text-[40px] uppercase mb-6 md:mb-8 lg:mb-10"
        >
          Partout en France
        </p>
        <div class="position-center">
          <a
            class="btn-landing-page z-10 bg-black text-white rounded-4xl py-3 px-8 md:py-3.5 md:px-10 lg:py-4 lg:px-12 text-base md:text-lg lg:text-xl hover:opacity-90 transition-all duration-300 ease-in-out hover:translate-y-[-3px] hover:shadow-lg relative overflow-hidden group"
            href="/site-applicatif"
            aria-label="Essayer Asafram - Découvrir la plateforme"
            ><span class="relative z-10">Essayer Asafram</span>
            <span
              class="absolute inset-0 bg-terre-cuite transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"
              aria-hidden="true"></span>
          </a>
        </div>
      </header>
      <div
        class="relative bottom-20 md:bottom-30 lg:bottom-50 xl:bottom-90 position-center mt-10 md:mt-0"
      >
        <img
          class="w-full md:w-[1400px] lg:w-[1900px]"
          src={FondAccueil.src}
          alt="Illustration représentant l'univers d'Asafram"
        />
      </div>
    </div>
  </section>
  <Transition className="bottom-8 md:bottom-14 lg:bottom-20 xl:bottom-32" />
  <div
    class="flex flex-col gap-12 md:gap-16 lg:gap-50 justify-center items-center px-10 sm:px-12 lg:px-40 md:px-24 pb-20 lg:pb-40"
  >
    <div
      class="flex flex-col md:flex-row md:items-center gap-8 md:gap-12 lg:gap-16 w-full"
    >
      <div class="md:w-1/2 order-1">
        <h3 class="text-center md:text-left mb-4">
          Des catalogues de produits du monde entiers
        </h3>
        <p class="text-sm md:text-lg xl:text-xl">
          Découvrez une large sélection de produits issus des quatre coins du
          globe. Que vous cherchiez des épices d'Inde, des sauces asiatiques ou
          des fromages portugais, ASAFRAM vous permet d'accéder facilement aux
          ingrédients essentiels pour cuisiner vos plats préférés.
        </p>
      </div>
      <div class="md:w-1/2 order-2">
        <div
          class="w-full h-[200px] md:h-[250px] lg:h-[300px] bg-gray-200 flex items-center justify-center rounded-lg shadow-sm"
          aria-label="Illustration de catalogues de produits internationaux"
          role="img"
        >
          <p class="text-gray-500 italic">Image à venir</p>
        </div>
      </div>
    </div>

    <div
      class="flex flex-col md:flex-row-reverse md:items-center gap-8 md:gap-12 lg:gap-16 w-full"
    >
      <div class="md:w-1/2">
        <h3 class="text-center md:text-left mb-4">
          Une carte interactive de toutes les boutiques
        </h3>
        <p class="text-sm md:text-lg xl:text-xl">
          Trouvez en un clin d'œil les boutiques et restaurants spécialisés près
          de chez vous. Grâce à notre carte interactive, explorez facilement les
          adresses proposant des produits authentiques du monde entier et
          laissez-vous guider vers de nouvelles découvertes culinaires.
        </p>
      </div>
      <div class="md:w-1/2">
        <div
          class="w-full h-[200px] md:h-[250px] lg:h-[300px] bg-gray-200 flex items-center justify-center rounded-lg shadow-sm"
          aria-label="Illustration de la carte interactive des boutiques"
          role="img"
        >
          <p class="text-gray-500 italic">Image à venir</p>
        </div>
      </div>
    </div>
  </div>

  <div
    class="bg-background rounded-lg p-6 md:p-10 lg:p-16 w-[80%] sm:w-[85%] md:w-[85%] lg:w-[90%] xl:w-[85%] 2xl:max-w-[1590px] mx-auto my-12 md:my-20"
  >
    <header class="mb-8 md:mb-10 lg:mb-16">
      <h3
        class="text-center !font-raleway text-xl sm:text-2xl md:text-3xl mb-4"
      >
        Une plateforme communautaire et une expérience utilisateur personnalisée
      </h3>
    </header>

    <div
      class="flex flex-col sm:flex-row flex-wrap justify-center items-center gap-8 sm:gap-6 md:gap-8 lg:gap-12 xl:gap-36"
      role="list"
      aria-label="Fonctionnalités principales"
    >
      <AccueilCard
        title="Recettes"
        description="Découvrez et partagez des milliers de recettes du globe grâce à des rubriques de cusines."
        image={IconeRecette.src}
        color="bg-sable"
      />

      <AccueilCard
        title="Communauté"
        description="Engagé avec des milliers d'utilisateurs d'origines et cultures différentes avec nos espaces commentaires."
        image={IconeCommunaute.src}
        color="bg-saumon"
      />

      <AccueilCard
        title="Favoris"
        description="Vivez une expérience personnalisé via des suggestions automatiques et une liste des favoris !"
        image={IconeFavoris.src}
        color="bg-orange-300"
      />
    </div>
  </div>

  <div class="mt-12 md:mt-40">
    <header class="mb-20 text-center">
      <h3
        class="text-center !font-raleway text-xl sm:text-2xl md:text-3xl mb-4 w-[80%] sm:w-[80%] md:w-[60%] lg:w-[70%] xl:w-[60%] mx-auto lg:mt-60 lg:mb-30"
      >
        Lisez les avis de nos utilisateurs de confiances qui utilisent ASAFRAM
        au quotidien pour retrouver leurs produits préférés !
      </h3>
    </header>

    <div
      class="relative w-full overflow-hidden"
      x-data="{
          position: 0,
          cardWidth: 65,
          speed: 0.07,
          animationFrame: null,
          isPaused: false,
          isTransitioning: false,
          
          calculateSpeed() {
            const baseSpeed = 0.07;
            const screenWidth = window.innerWidth;
            
            if (screenWidth < 640) {
              return baseSpeed * 2.5;
            } else if (screenWidth < 1024) {
              return baseSpeed * 1.8;
            } else {
              return baseSpeed;
            }
          },
          
          startContinuousSlide() {
            this.speed = this.calculateSpeed();
            
            window.addEventListener('resize', () => {
              this.speed = this.calculateSpeed();
            });
            
            const animate = () => {
              if (!this.isPaused && !this.isTransitioning) {
                this.position -= this.speed;
                
                if (this.position <= -260) {
                  this.isTransitioning = true;
                  
                  const carousel = document.getElementById('infinite-carousel');
                  if (carousel) {
                    carousel.style.transition = 'none';
                    
                    void carousel.offsetWidth;
                    
                    this.position = 0;
                    carousel.style.transform = `translateX(0%)`;
                    
                    setTimeout(() => {
                      carousel.style.transition = 'transform 500ms linear';
                      this.isTransitioning = false;
                    }, 50);
                  }
                }
              }
              
              this.animationFrame = requestAnimationFrame(animate);
            };
            
            this.animationFrame = requestAnimationFrame(animate);
          },
          
          stopAnimation() {
            if (this.animationFrame) {
              cancelAnimationFrame(this.animationFrame);
              this.animationFrame = null;
            }
          },
          
          pauseAnimation() {
            this.isPaused = true;
          },
          
          resumeAnimation() {
            this.isPaused = false;
          },
          
          goToPosition(pos) {
            this.position = -pos * this.cardWidth;
            
            const carousel = document.getElementById('infinite-carousel');
            if (carousel) {
              carousel.style.transform = `translateX(${this.position}%)`;
            }
            
            setTimeout(() => this.resumeAnimation(), 1500);
          }
        }"
      x-init="startContinuousSlide()"
    >
      <div
        class="relative w-full py-4"
        aria-roledescription="carousel"
        aria-label="Témoignages de nos utilisateurs"
      >
        <ul
          id="infinite-carousel"
          class="flex will-change-transform gap-x-60"
          style="transition: transform 500ms linear;"
          :style="'transform: translateX(' + position + '%)'"
          role="list"
          aria-live="polite"
        >
          <li class="w-[65%] -mx-[5%] first:ml-0" role="listitem">
            <CardCommentaires
              name="Linh"
              profession="Étudiante"
              title="Retrouver les saveurs de mon enfance"
              content="Grâce à ASAFRAM, j'ai pu localiser une boutique spécialisée à côté de chez moi. Cette plateforme me permet de garder un lien fort avec ma culture ! Je recommande !"
              imageUrl={ImageLinh.src}
            />
          </li>

          <li class="w-[65%] -mx-[5%]" role="listitem">
            <CardCommentaires
              name="Thomas"
              profession="Apprenti cuisinier"
              title="Une mine d'or pour les amateurs de cuisine !"
              content="J'adore expérimenter avec des saveurs du monde entier. ASAFRAM m'a aidé à trouver des fournisseurs de qualité pour mes recettes. C'est une ressource précieuse pour tous les passionnés de gastronomie."
              imageUrl={ImageThomas.src}
            />
          </li>

          <li class="w-[65%] -mx-[5%]" role="listitem">
            <CardCommentaires
              name="Aïcha"
              profession="Infirmière"
              title="Enfin des produits authentiques !"
              content=" Avec ASAFRAM, j'ai découvert plusieurs épiceries africaines près de chez moi que je ne connaissais pas du tout ! Maintenant, je peux acheter mes ingrédients sans faire des kilomètres et retrouver facilement les saveurs de mon enfance."
              imageUrl={ImageAicha.src}
            />
          </li>

          <li class="w-[65%] -mx-[5%]" role="listitem">
            <CardCommentaires
              name="Yanis"
              profession="Consultant"
              title="Une plateforme qui rassemble tout"
              content="Avant, je devais faire le tour de plusieurs épiceries pour mettre la main sur des épices ou des produits spécifiques. ASAFRAM m'a énormément facilité la tâche en regroupant toutes les boutiques spécialisées sur une seule plateforme."
              imageUrl={ImageYanis.src}
            />
          </li>

          <li class="w-[65%] -mx-[5%] first:ml-0" role="listitem">
            <CardCommentaires
              name="Linh"
              profession="Étudiante"
              title="Retrouver les saveurs de mon enfance"
              content="Grâce à ASAFRAM, j'ai pu localiser une boutique spécialisée à côté de chez moi. Cette plateforme me permet de garder un lien fort avec ma culture ! Je recommande !"
              imageUrl={ImageLinh.src}
            />
          </li>

          <li class="w-[65%] -mx-[5%]" role="listitem">
            <CardCommentaires
              name="Thomas"
              profession="Apprenti cuisinier"
              title="Une mine d'or pour les amateurs de cuisine !"
              content="J'adore expérimenter avec des saveurs du monde entier. ASAFRAM m'a aidé à trouver des fournisseurs de qualité pour mes recettes. C'est une ressource précieuse pour tous les passionnés de gastronomie."
              imageUrl={ImageThomas.src}
            />
          </li>

          <li class="w-[65%] -mx-[5%]" role="listitem">
            <CardCommentaires
              name="Aïcha"
              profession="Infirmière"
              title="Enfin des produits authentiques !"
              content=" Avec ASAFRAM, j'ai découvert plusieurs épiceries africaines près de chez moi que je ne connaissais pas du tout ! Maintenant, je peux acheter mes ingrédients sans faire des kilomètres et retrouver facilement les saveurs de mon enfance."
              imageUrl={ImageAicha.src}
            />
          </li>

          <li class="w-[65%] -mx-[5%]" role="listitem">
            <CardCommentaires
              name="Yanis"
              profession="Consultant"
              title="Une plateforme qui rassemble tout"
              content="Avant, je devais faire le tour de plusieurs épiceries pour mettre la main sur des épices ou des produits spécifiques. ASAFRAM m'a énormément facilité la tâche en regroupant toutes les boutiques spécialisées sur une seule plateforme."
              imageUrl={ImageYanis.src}
            />
          </li>
        </ul>

        <!-- Boutons pause/play pour l'accessibilité -->
        <div class="absolute bottom-0 right-4 flex items-center gap-2 z-10">
          <button
            @click="pauseAnimation()"
            x-show="!isPaused"
            class="p-2 bg-white rounded-full shadow-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-terre-cuite"
            aria-label="Mettre en pause le défilement des témoignages"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <rect x="6" y="4" width="4" height="16"></rect>
              <rect x="14" y="4" width="4" height="16"></rect>
            </svg>
          </button>
          <button
            @click="resumeAnimation()"
            x-show="isPaused"
            class="p-2 bg-white rounded-full shadow-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-terre-cuite"
            aria-label="Reprendre le défilement des témoignages"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <polygon points="5,3 19,12 5,21"></polygon>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <Transition
    isReversed="true"
    className="top-10 md:top-20 lg:top-20 xl:top-32"
  />
  <section class="bg-background section-content">
    <header class="py-12">
      <h2 class="mt-20 lg:mt-40 md:mb-20 lg:mb-32">ASAFRAM, C'EST :</h2>
    </header>
    <ul
      class="flex justify-center items-center flex-col gap-8 md:flex-row md:gap-12 lg:gap-24 xl:gap-36 pb-12 md:pb-24 lg:pb-32 xl:pb-60"
    >
      <li>
        <BulleAccueil
          circleColor="bg-sable"
          image={IconeBoutique.src}
          nombre="500"
          text="Boutiques partenaires"
        />
      </li>
      <li>
        <BulleAccueil
          circleColor="bg-saumon"
          image={IconePlanete.src}
          nombre="10 000"
          text="Produits de pays différents"
        />
      </li>
      <li>
        <BulleAccueil
          circleColor="bg-sable"
          image={IconeRestaurants.src}
          nombre="1 000"
          text="Recettes du monde entier"
        />
      </li>
      <li>
        <BulleAccueil
          circleColor="bg-saumon"
          image={IconeCompte.src}
          nombre="15 000"
          text="Utilisateurs fidèles"
        />
      </li>
    </ul>
  </section>

  <div class="bg-white pt-12 md:pt-24 lg:pt-32">
    <section class="bg-sable mx-12 md:mx-24 lg:mx-32 rounded-t-lg">
      <header>
        <h2 class="text-center pt-16">Commencer à retrouver les saveurs !</h2>
      </header>
      <p class="text-center font-bold mt-6">
        Brisez les frontières de la cuisine et inscrivez-vous sur notre
        plateforme dès maintenant.
      </p>
      <div class="position-center py-12">
        <a
          class="btn-landing-page flex items-center justify-center gap-4"
          href=""
          aria-label="S'inscrire à ASAFRAM"
        >
          <img class="w-6" src={IconeEnvoyer.src} alt="" aria-hidden="true" />
          <p>S'inscrire</p>
        </a>
      </div>
    </section>
  </div>
</Layout>
